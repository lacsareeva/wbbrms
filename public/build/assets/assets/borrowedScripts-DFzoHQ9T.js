function y(e){const t=e.target.value;t.split("-")[0].length>4&&(e.target.value=t.slice(0,10))}window.limitYearInput=y;document.querySelectorAll("#create_borrow_date, #create_return_date, #update_borrow_date, #update_return_date").forEach(function(e){e.addEventListener("input",y)});const g=document.getElementById("create_borrow_date"),I=document.getElementById("create_return_date");function f(){const e=new Date,t=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0"),u=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0");return`${t}-${l}-${c}T${u}:${n}`}const m=f();g.min=m;f();I.min=m;g.value=m;I.value=m;function B(e){document.getElementById("view-request-modal").style.display="block";function t(u){if(!u)return"";const n=new Date(u),i=n.getFullYear(),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),d=String(n.getMinutes()).padStart(2,"0");return`${i}-${s}-${a} ${o}:${d}`}document.getElementById("view_id").value=e.id||"",document.getElementById("view_ids").value=e.id||"",document.getElementById("view_sender").value=e.sender||"",document.getElementById("view_name").textContent=e.name||"",document.getElementById("view_address").textContent=e.address||"",document.getElementById("view_equipment").textContent=e.equipment||"",document.getElementById("view_quantity").textContent=e.quantity||"",document.getElementById("view_purpose").textContent=e.purpose||"",document.getElementById("view_contact").textContent=e.contact||"",document.getElementById("view_borrow_date").textContent=t(e["borrow-date"]||""),document.getElementById("view_return_date").textContent=t(e["return-date"]||"");const l=document.getElementById("reject_button"),c=document.getElementById("accept_button");l.replaceWith(l.cloneNode(!0)),c.replaceWith(c.cloneNode(!0)),document.getElementById("reject_button").addEventListener("click",function(n){n.preventDefault(),document.getElementById("response_accepted_info").style.display="none",document.getElementById("response_rejected_info").style.display="block";function i(s=null){Swal.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes",cancelButtonText:"Cancel"}).then(a=>{if(a.isConfirmed){const o=s||document.getElementById("view_id").value;if(!o||o.trim()===""){Swal.fire("Error!","No record selected for deletion or the table is empty.","error");return}const d=document.getElementById("view-form");d.action=d.action.replace(":id",o),d.submit()}})}window.rejectRequest=i}),document.getElementById("accept_button").addEventListener("click",function(n){n.preventDefault(),document.getElementById("response_rejected_info").style.display="none",document.getElementById("response_accepted_info").style.display="block";function i(s=null){Swal.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes",cancelButtonText:"Cancel"}).then(a=>{if(a.isConfirmed){const o=s||document.getElementById("view_ids").value;if(!o||o.trim()===""){Swal.fire("Error!","No record selected for deletion or the table is empty.","error");return}const d=document.getElementById("update-forms");d.action=d.action.replace(":id",o),d.submit()}})}window.acceptRequest=i})}window.viewBorrowed=B;function w(e){document.getElementById("update-request-modal").style.display="block";function t(c){if(!c)return"";const u=new Date(c),n=u.getFullYear(),i=String(u.getMonth()+1).padStart(2,"0"),s=String(u.getDate()).padStart(2,"0"),a=String(u.getHours()).padStart(2,"0"),o=String(u.getMinutes()).padStart(2,"0");return`${n}-${i}-${s}T${a}:${o}`}document.getElementById("update_name").value=e.name||"",document.getElementById("update_address").value=e.address||"",document.getElementById("update_equipment").value=e.equipment||"",document.getElementById("customInputs").value=e.equipment||"",document.getElementById("update_quantity").value=e.quantity||"",document.getElementById("update_purpose").value=e.purpose||"",document.getElementById("update_contact").value=e.contact||"",document.getElementById("update_borrow_date").value=t(e["borrow-date"]),document.getElementById("update_return_date").value=t(e["return-date"]),document.getElementById("update_equipment").value===""&&(document.getElementById("customInputs").style.display="block",document.getElementById("update_equipment").style.display="none");const l=document.getElementById("update-form");l&&e.id&&(l.action=`borrowed/update/${e.id}`)}window.editBorrowed=w;function E(e){Swal.fire({title:"Return equipment?",text:"",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Return",cancelButtonText:"Cancel"}).then(t=>{t.isConfirmed&&(window.location.href=`borrowed/deletes/${e}`)})}window.confirmDelete=E;function _(){const t=document.getElementById("search").value.toLowerCase(),c=document.getElementById("borrowedTable").getElementsByTagName("tr");let u=0,n=0;for(let a=1;a<c.length;a++){const o=c[a],d=o.getElementsByTagName("td");let p=!1;if(o.id!=="noDataRow"){u++;for(let r=0;r<d.length;r++)if(d[r]&&(d[r].textContent||d[r].innerText).toLowerCase().includes(t)){p=!0;break}p?(o.style.display="",n++):o.style.display="none"}}const i=document.getElementById("noDataRow");i.style.display=n===0?"":"none";const s=document.getElementById("countValue");s.textContent=`${n} of ${u}`}window.filterTable=_;function v(){document.getElementById("update-request-modal").style.display="none"}window.closeUpdateWalkInRequestModal=v;function h(){document.getElementById("view-request-modal").style.display="none"}window.closeRequestModal=h;function q(){document.getElementById("response_accepted_info").style.display="none",document.getElementById("response_rejected_info").style.display="none",document.getElementById("view_accepted_response").value="",document.getElementById("view_rejected_response").value="",acceptRequest(id=null),rejectRequest(id=null)}window.closeModal=q;function C(){document.getElementById("walk-in-request-modal").style.display="block",document.getElementById("create_address").focus()}window.openWalkInRequestModal=C;function S(){document.getElementById("walk-in-request-modal").style.display="none"}window.closeWalkInRequestModal=S;document.getElementById("Fullname").addEventListener("input",function(e){this.value=this.value.replace(/[^A-Za-z\s]/g,"")});document.getElementById("update_contact").addEventListener("input",function(e){this.value=(this.value.match(/\d+/)||[]).join("")});document.getElementById("create_contact").addEventListener("input",function(e){this.value=this.value.replace(/\D/g,"")});function R(e){var t=document.getElementById("customInput"),l=document.getElementById("equipment");e.value==="other"?(t.style.display="block",l.style.display="none",t.name="equipment"):(t.style.display="none",l.style.display="block",t.name="custom_input")}window.toggleInput=R;function k(e){var t=document.getElementById("customInputs"),l=document.getElementById("update_equipment");e.value==="other"?(t.style.display="block",l.style.display="none",t.name="equipment"):(t.style.display="none",l.style.display="block",t.name="custom_input")}window.toggleInputs=k;
